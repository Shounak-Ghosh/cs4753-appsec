1. XSS Attack: /buy/1?director=<script>alert("XSS")</script>. view.py references a director parameter in buy_card_view. Upon checking the template (items-single.html) we find <p>Endorsed by {{director|safe}}!</p> -- this marks the HTML as "safe", allowing us to pass in script code here.

2. The XSRF attack targets an already logged in user, and forces them to buy a gift card for another user. This occurs by crafting an HTML file that auto-submits a form when the file is loaded. The form contains a GET request with the (username, amount) fields set by the attacker. This can be remediated by disabling GET requests in the gift_card_view method in views.py. We also include 'django.middleware.csrf.CsrfViewMiddleware' in settings.py, and include {% csrf_token %} in every HTML form.

3. This attack involved crafting a malicious giftcard with a SQL statement in the signature. The SQl statement (' UNION SELECT password FROM LegacySite_user WHERE username='admin' --) unions with the existing SELECT statement and uses -- to comment out the rest of the query. This effectively retrieves the admin password in the query response. The fix involved using creating parameterized queries using Django, which treats the signature as a value, not SQL syntax.

4. The command injection attack involved creating a giftcard that breaks JSON structure, which triggers a system call which uses the card filename as input. Maliciously crafting the filename (cmdi.giftcrd; touch pwned #) allows us execute a file creation operation. This can be fixed by using a subprocess to write the giftcard to a temp file, instead of a direct system call.
